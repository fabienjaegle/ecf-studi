{% extends 'admin.html.twig' %}

{% block body %}
	<a href="{{ path('app_dashboard_admin_franchises_list') }}" role="button" class="btn btn-outline-success mt-3">Liste des franchises</a>
	<div class="col-12">
		<div class="card">
			<div class="card-body d-flex">
				<div class="col-2">
					<img class="img-fluid rounded" width="90" height="90" src="{{ franchise.client.logourl ? franchise.client.logourl : asset('assets/img/no-logo.png') }}" alt="{{ franchise.client.clientname }}"/>
				</div>
				<div class="col-5 px-2">
					<p class="card-text">Nom du client :
						{{ franchise.client.clientname }}</p>
					<p class="card-text">Description complète :
						{{ franchise.client.fullDescription }}</p>
				</div>
				<div class="col-5 px-2">
					<p class="card-text">URL :
						<a href="http://{{ franchise.client.url }}">{{ franchise.client.url }}</a>
					</p>
					<p class="card-text">Délégué à la Protecton des données (DPO) :
						{{ franchise.client.dpo }}</p>
					<p class="card-text">Contact technique :
						{{ franchise.client.technicalContact }}</p>
					<p class="card-text">Contact commercial :
						{{ franchise.client.commercialContact }}</p>
				</div>
			</div>
			<div class="card-body d-flex">
				<div class="form-check form-switch">
					<input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" {{ franchise.client.active ? 'checked' : '' }} disabled>
					<label class="form-check-label" for="flexSwitchCheckDefault">{{ franchise.client.active ? 'Actif': 'Non actif' }}</label>
				</div>
			</div>
		</div>
	</div>
	<div class="form-control my-3">
		<form role="search" id="nav-search-form" method="post" action="{{ path('app_dashboard_admin_search') }}">
			<div class="d-flex justify-content-between">
				<input class="form-control form-control-dark rounded-0 border-0" id="branch_id" name="branch_id" type="text" placeholder="branch_id" aria-label="Nom du client">
				<div class="d-flex justify-content-between">
					<a href="#" class="btn btn-outline-primary">Toutes</a>
				</div>
			</div>
			<div class="d-flex justify-content-between">
				<div class="btn-group me-2">
					<a href="#" class="btn btn-outline-primary">Actif</a>
					<a href="#" class="btn btn-outline-primary">Non actif</a>
				</div>
				<a href="{{ path('app_dashboard_admin_new_structure', {'id': franchise.id}) }}" class="btn btn-outline-primary">Ajouter</a>
			</div>
		</form>
	</div>
	<div class="row">
		{% for structure in structures %}
			<div class="col-xl-12 col-sm-12 col-12 my-3">
				<div class="card">
					<div class="card-body">
						<div class="media d-flex">
							<div class="align-self-center">
								<img class="img-fluid float-left" width="90" height="90" src="{{ structure.client.logourl ? structure.client.logourl : asset('assets/img/no-logo.png') }}" alt="{{ structure.client.clientname }}"/>
							</div>
							<div class="media-body text-right mx-3">
								<p class="card-text">client_id:
									<a href="{{ path('app_dashboard_admin_structure_details', {'id': franchise.id, 'structure_id': structure.id}) }}">{{ structure.client.clientId }}</a>
								</p>
								<p class="card-text">install_id:
									{% if structure.client.grants %}
										{{ structure.client.grants.installId }}
									{% endif %}
								</p>

								<p class="card-text">branch_id:
									{% if structure.client.grants %}
										{{ structure.client.grants.branchId }}
									{% endif %}
								</p>
							</div>
						</div>
						<div class="media d-flex mt-3">
							<div class="form-check form-switch">
								<input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" {{ structure.client.active ? 'checked' : '' }} disabled>
								<label class="form-check-label" for="flexSwitchCheckDefault">{{ structure.client.active ? 'Actif': 'Non actif' }}</label>
							</div>
						</div>
					</div>
				</div>
				<div class="form-control">
					<div class="d-flex justify-content-between">
						<div></div>
						<div>
							<a href="#" data-bs-toggle="collapse" data-bs-target="#permissions-collapse-{{ structure.id }}" aria-expanded="false">
								Permissions
								<i class="fa fa-plus"></i>
							</a>
						</div>

					</div>
					<div class="collapse" id="permissions-collapse-{{ structure.id }}">

						{% if structure.client.grants %}
							TODO Les permissions
						{% else %}
							<a href="{{ path('app_dashboard_admin_structure_add_permissions', {'id': structure.id, 'client_id': structure.client.id}) }}" class="btn btn-outline-primary">Ajouter</a>
						{% endif %}

					</div>
				</div>
			</div>
		{% else %}
			<p>Aucune structure associée pour le moment.</p>
		{% endfor %}
	</div>
{% endblock %}
